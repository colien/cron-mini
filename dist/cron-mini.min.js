!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CronMini=e():t.CronMini=e()}(self,(function(){return(()=>{var t={990:(t,e)=>{function r(t){var e=[];if(t.indexOf("-")>-1){for(var r=t.split(/[-]/g),n=parseInt(r[0]),i=Math.min(parseInt(r[1]),60),o=n;o<=i;o++)e.push(o);return e}if(t.indexOf("/")>-1){r=t.split(/[\/]/g),n=parseInt(r[0]);var s=parseInt(r[1]);for(o=n;o<=60;o+=s)e.push(o);return e}return[parseInt(t)]}function n(t,e,r){for(var n={times:[]},i=0;i<t.length;i++){var o=t[i];o>=e&&o<=r&&n.times.push(o)}return n.times.sort((function(t,e){return t-e})),n}e.CronParser=function t(e){if(!(this instanceof t))return new t(e);this.cron=e;var i=function(t){for(var e=t.split(" "),n=/^((([0-9]{1,2}([-\/][0-9]{1,2})?)(,[0-9]{1,2}([-\/][0-9]{1,2})?)*)|[\*\?])$/,i=[],o=e.length;o<6;o++)e[o].push("*");for(var s=0;s<e.length;s++){var a=e[s];if(!n.test(a))return;if("*"!=a&&"?"!=a)if(a.indexOf(",")>-1){var u=a.split(/[\,]/g),c=[];for(o=0;o<u.length;o++)c=c.concat(r(u[o]));i.push(c)}else i.push(r(a));else i.push(r("0-60"))}return i}(this.cron);this.timeEnum=function(t){if(!t)return{};for(var e={},r=0;r<t.length;r++){var i=t[r];0==r?e.second=n(i,0,59):1==r?e.minute=n(i,0,59):2==r?e.hour=n(i,0,23):3==r?e.day=n(i,1,31):4==r?e.month=n(i,1,12):e.week=n(i,1,7)}return e}(i)}},901:(t,e,r)=>{var n=r(648).getUUId;function i(t,e){if(!(this instanceof i))return new i(t);this.timeout=null,this.interval=null,this.opts=t,this.cb=e,this.id=n(),this.status=!1}i.prototype.setTimeout=function(t,e){return this.status=!0,this.timeout=setTimeout((function(){t()}),e),this.timeout},i.prototype.setInterval=function(t,e){return this.status=!0,this.interval=setInterval((function(){t()}),e),this.interval},i.prototype.clear=function(){this.clearInterval(),this.clearTimeout()},i.prototype.clearInterval=function(){clearInterval(this.interval),this.interval=null,this.interval||this.timeout||(this.status=!1)},i.prototype.clearTimeout=function(){clearTimeout(this.timeout),this.timeout=null,this.interval||this.timeout||(this.status=!1)},i.prototype.start=function(){var t=this,e=this.opts;e.timeout?e.interval?t.setTimeout((function(){t.clearTimeout(),t.setInterval((function(){t.cb()}),e.interval),e.immedi&&t.cb()}),e.timeout):t.setTimeout((function(){t.clearTimeout(),t.cb()}),e.timeout):e.interval?t.setInterval((function(){t.cb()}),e.interval):t.cb()},e.CustomTimer=i},648:(t,e)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t){return"[object Number]"==Object.prototype.toString.call(t)}function i(t){return t instanceof Date}var o,s,a,u;e.isObject=function(t){return"[object Object]"==Object.prototype.toString.call(t)&&null!==t},e.isFun=function(t){return"[object Function]"==Object.prototype.toString.call(t)},e.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},e.isString=function(t){return"[object String]"==Object.prototype.toString.call(t)},e.isNumber=n,e.isDate=i,e.getDaysInYearMonth=function(t,e,r){return r=r||0,new Date(t,e,r)},e.getTargetDate=function(t,e){var r=new Date;if(i(t)?r=t:n(t)&&(e=t),e){var o=r.getDate()+e;r=new Date(r.setDate(o))}return{year:r.getFullYear(),week:r.getDay(),month:r.getMonth()+1,day:r.getDate(),hour:r.getHours(),minute:r.getMinutes(),second:r.getSeconds(),date:r}},e.getUUId=function(){var t=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(16)}))},Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length,r=Number(arguments[1])||0;for(r<0&&(r+=e);r<e;){if(r in this&&this[r]===t)return r;r++}return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var r=arguments[1],n=0;n<e;n++)n in this&&t.call(r,this[n],n,this)}),Array.prototype.map||(Array.prototype.map=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var r=new Array(e),n=arguments[1],i=0;i<e;i++)i in this&&(r[i]=t.call(n,this[i],i,this));return r}),Array.prototype.filter||(Array.prototype.filter=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var r=new Array,n=arguments[1],i=0;i<e;i++)i in this&&t.call(n,this[i],i,this)&&r.push(val);return r}),Array.prototype.some||(Array.prototype.some=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var r=arguments[1],n=0;n<e;n++)if(n in this&&t.call(r,this[n],n,this))return!0;return!1}),Array.prototype.every||(Array.prototype.every=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var r=arguments[1],n=0;n<e;n++)if(n in this&&!t.call(r,this[n],n,this))return!1;return!0}),Object.keys||(Object.keys=(o=Object.prototype.hasOwnProperty,s=!{toString:null}.propertyIsEnumerable("toString"),u=(a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(t){if("object"!==r(t)&&"function"!=typeof t||null===t)throw new TypeError("Object.keys called on non-object");var e=[];for(var n in t)o.call(t,n)&&e.push(n);if(s)for(var i=0;i<u;i++)o.call(t,a[i])&&e.push(a[i]);return e})),Object.assign||(Object.assign=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r})}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}var n={};return(()=>{var t=n;function e(){return e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},e.apply(this,arguments)}var i=r(990).CronParser,o=r(901).CustomTimer,s=r(648),a=s.isString,u=s.isObject,c=s.getDaysInYearMonth,p=s.getTargetDate;function f(t,e){if(!(this instanceof f))return new f(t);this.opts={},this.type,this.timers=[],this.cb=e,this.wake=t.wake||36e5,this.init(t)}function h(t,e,r,n){for(var i=t.times,o=parseInt((e+n)/r),s=parseInt((e+n)%r),a=0;a<i.length;a++)if(i[a]>=s&&s<r)return[i[a],o];return[i[0],o+1]}t.CronActuator=f,f.prototype.init=function(t){if(a(t)&&(this.type=2,this.opts=new i(t),this.opts.timeout=null,this.opts.interval=null),u(t)){var r={};t.cron?(this.type=3,r=new i(t.cron),t.timeout||(this.type=2),this.opts.interval=null):this.type=1,this.opts=e(t,r)}},f.prototype.start=function(){this.opts.real=1===this.type,this.createTimer({timeout:this.opts.timeout,interval:this.opts.interval,real:this.opts.real,immedi:this.opts.immedi,targetTime:""},1)},f.prototype.createTimer=function(t,e){var r=this,n=new o(t,(function(){r.createNextTimer(),n.status||r.cancel(n),t.real&&r.cb(t)}));this.timers.push(n),n.start()},f.prototype.createNextTimer=function(){var t=this.opts;if(1!=this.type&&t.timeEnum){var e=function(t,e){for(var r=t.timeEnum,n=r.month,i=r.week,o=r.day,s=r.hour,a=r.minute,u=r.second,f=p(),l=p(parseInt(e/36e5)),y=["second","minute","hour","day","month"],m=y.length-1;m>=0&&!((O=r[y[m]].times).indexOf(f[y[m]])<0);m--);for(var v,g,b,x,d=!1,w=[],T=0;T<y.length;T++){var O=r[y[T]].times;if(T<m)w.push(O[0]);else{if("second"==y[T]&&(v=h(u,f.second,60,1),w.push(v[0])),"minute"==y[T]&&(g=h(a,f.minute,60,v?v[1]:1),w.push(g[0])),"hour"==y[T]&&(b=h(s,f.hour,24,g?g[1]:1),w.push(b[0])),"day"==y[T]){var j=c(f.year,f.month).getDate(),I=h(o,f.day,j+1,b?b[1]:1);w.push(I[0])}"month"==y[T]&&(x=h(n,f.month,13,I?I[1]:1),w.push(x[0]))}}var S=new Date(f.year+(x?x[1]:1),w[4]-1,w[3],w[2],w[1],w[0]),A=S.getTime()<=l.date.getTime();return i.times.indexOf(S.getDay()||7)>-1&&A&&(e=S.getTime()-f.date.getTime(),d=!0),{timeLen:e,real:d,targetTime:S}}(t,this.wake),r={timeout:e.timeLen,interval:0,real:e.real,targetTime:e.targetTime};this.createTimer(r,2)}},f.prototype.stop=f.prototype.clearAll=function(){if(this.timers&&this.timers.length)for(var t=this.timers.length-1;t>=0;t--){var e=this.timers[t];this.cancel(e)}this.timers=[]},f.prototype.cancel=function(t,e){if(t)for(var r=this.timers,n=0;n<r.length;n++)r[n].id===t.id&&(r.splice(n,1)[0].clear(),t&&t.clear());e&&e()}})(),n})()}));